<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Team Maker Pro</title>

<style>
*{box-sizing:border-box;font-family:Vazirmatn,Tahoma}
body{
  margin:0;
  background:linear-gradient(135deg,#e9f5ff,#ffffff);
  color:#0a2540;
}

/* ===== Splash ===== */
#splash{
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  background:#ffffff;
  z-index:100;
}
#ball{
  font-size:90px;
  animation:spin .5s linear forwards;
}
@keyframes spin{
  0%{transform:rotate(0deg);opacity:1}
  100%{transform:rotate(360deg);opacity:0}
}

/* ===== Layout ===== */
.container{
  max-width:900px;
  margin:auto;
  padding:16px;
}
.card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  box-shadow:0 20px 40px rgba(0,0,0,.08);
  margin-bottom:16px;
}

/* ===== Inputs ===== */
input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid #ddd;
  font-size:15px;
}
.roles{
  display:flex;
  gap:10px;
  margin-top:10px;
}
.role{
  flex:1;
  padding:12px;
  border-radius:12px;
  text-align:center;
  font-weight:700;
  cursor:pointer;
  background:#f1f5f9;
}
.role.active{
  background:#38bdf8;
  color:#fff;
}

/* ===== Buttons ===== */
button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  font-weight:800;
  cursor:pointer;
  margin-top:10px;
}
.primary{background:#0ea5e9;color:#fff}
.admin{background:#facc15;color:#000}
.ghost{background:#e5e7eb}

/* ===== Teams ===== */
.teams{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
@media(max-width:700px){
  .teams{grid-template-columns:1fr}
}
.team h3{
  margin:0 0 8px;
  font-size:16px;
}
ul{list-style:none;padding:0;margin:0}
li{
  background:#f8fafc;
  padding:8px 10px;
  border-radius:10px;
  margin-bottom:6px;
  font-size:14px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* ===== Toast ===== */
#toast{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:#0a2540;
  color:#fff;
  padding:10px 14px;
  border-radius:10px;
  display:none;
}
</style>
</head>

<body>

<div id="splash"><div id="ball">âš½</div></div>

<div class="container">

  <div class="card">
    <input id="name" placeholder="Ù†Ø§Ù… Ø´Ù…Ø§">
    <div class="roles">
      <div class="role" data-role="player">âš½ Ø¨Ø§Ø²ÛŒÚ©Ù†</div>
      <div class="role" data-role="gk">ğŸ§¤ Ø¯Ø±ÙˆØ§Ø²Ù‡â€ŒØ¨Ø§Ù†</div>
    </div>
    <button class="primary" id="register">Ø«Ø¨Øª</button>
  </div>

  <div class="card teams">
    <div>
      <h3>ğŸ”µ ØªÛŒÙ… A</h3>
      <ul id="A"></ul>
      <h3>ØªØ¹ÙˆÛŒØ¶ÛŒ A</h3>
      <ul id="As"></ul>
    </div>
    <div>
      <h3>ğŸ”´ ØªÛŒÙ… B</h3>
      <ul id="B"></ul>
      <h3>ØªØ¹ÙˆÛŒØ¶ÛŒ B</h3>
      <ul id="Bs"></ul>
    </div>
  </div>

  <div class="card">
    <button class="ghost" id="shuffle">ğŸ”€ Ù‚Ø§Ø·ÛŒâ€ŒÚ©Ø±Ø¯Ù† (Ø§Ø¯Ù…ÛŒÙ†)</button>
    <button class="admin" id="reset">ğŸ” Ø±ÛŒØ³Øª (Ø§Ø¯Ù…ÛŒÙ†)</button>
  </div>

</div>

<div id="toast"></div>

<script>
const ADMIN="admin12345";
const KEY="TEAM_APP_V7";
const DEV="DEV_V7";

const toast=t=>{const x=document.getElementById("toast");x.innerText=t;x.style.display="block";setTimeout(()=>x.style.display="none",1500)}

setTimeout(()=>document.getElementById("splash").remove(),600);

let role=null;
document.querySelectorAll(".role").forEach(r=>{
  r.onclick=()=>{
    document.querySelectorAll(".role").forEach(x=>x.classList.remove("active"));
    r.classList.add("active");
    role=r.dataset.role;
  }
});

let device=localStorage.getItem(DEV)||(()=>{let d=Math.random();localStorage.setItem(DEV,d);return d})();

let state=JSON.parse(localStorage.getItem(KEY)||'{"players":[]}');

function save(){localStorage.setItem(KEY,JSON.stringify(state));render()}

function assign(p){
  let A=state.players.filter(x=>x.team=="A"&&!x.sub);
  let B=state.players.filter(x=>x.team=="B"&&!x.sub);
  if(A.length<5||B.length<5){
    p.team=(A.length<=B.length?"A":"B");
    p.sub=false;
  }else{
    p.team=(Math.random()<.5?"A":"B");
    p.sub=true;
  }
}

document.getElementById("register").onclick=()=>{
  const name=document.getElementById("name").value.trim();
  if(!name||!role)return toast("Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù†Ø§Ù‚Øµ");
  if(state.players.some(p=>p.device==device))return toast("Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øª Ø´Ø¯ÛŒ");
  let p={name,role,device};
  assign(p);
  state.players.push(p);
  save();
  toast("Ø«Ø¨Øª Ø´Ø¯");
};

document.getElementById("reset").onclick=()=>{
  if(prompt("Ø±Ù…Ø²")!=ADMIN)return;
  state={players:[]};
  localStorage.removeItem(DEV);
  save();
};

document.getElementById("shuffle").onclick=()=>{
  if(prompt("Ø±Ù…Ø²")!=ADMIN)return;
  state.players.forEach(p=>{delete p.team;delete p.sub});
  state.players.sort(()=>Math.random()-.5).forEach(assign);
  save();
};

function render(){
  ["A","B","As","Bs"].forEach(id=>document.getElementById(id).innerHTML="");
  state.players.forEach(p=>{
    let id=p.team+(p.sub?"s":"");
    document.getElementById(id).innerHTML+=`<li>${p.role=="gk"?"ğŸ§¤":"âš½"} ${p.name}</li>`;
  });
}
render();
</script>

</body>
</html>
