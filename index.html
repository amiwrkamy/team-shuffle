<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Random Team</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
*{box-sizing:border-box;font-family:tahoma}
body{
margin:0;
background:radial-gradient(circle at top,#1e88e5,#0d1b2a,#000);
color:#fff;
min-height:100vh;
overflow-x:hidden;
}
#loader{
position:fixed;inset:0;
display:flex;align-items:center;justify-content:center;
background:#000;z-index:10;
}
.ball{
width:80px;height:80px;border-radius:50%;
background:radial-gradient(circle,#fff 30%,#000 31%);
animation:spin .5s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

.container{max-width:420px;margin:auto;padding:12px}
h1{text-align:center;margin:8px 0;font-size:22px}

.card{
background:rgba(255,255,255,.08);
backdrop-filter:blur(8px);
border-radius:16px;
padding:14px;
box-shadow:0 10px 30px rgba(0,0,0,.5);
}

input{
width:100%;padding:12px;border-radius:10px;
border:none;font-size:16px;margin-bottom:10px;
}

.btn{
width:100%;padding:12px;border:none;
border-radius:12px;font-size:16px;
cursor:pointer;color:#fff;
margin-top:6px;
}

.player{background:#2196f3}
.keeper{background:#e53935}
.submit{
background:linear-gradient(135deg,#00c853,#00b0ff);
font-weight:bold;
}

.hidden{display:none}

.teams{
display:grid;grid-template-columns:1fr 1fr;gap:10px;
margin-top:10px;
}
.team{
background:rgba(0,0,0,.4);
border-radius:14px;padding:10px;
}
.team h3{text-align:center;margin:4px 0;font-size:15px}
ul{padding:0;margin:0;list-style:none}
li{
background:rgba(255,255,255,.1);
margin:4px 0;padding:6px 8px;
border-radius:8px;
font-size:14px;
white-space:nowrap;
overflow:hidden;text-overflow:ellipsis;
}

.admin{
position:fixed;top:6px;right:6px;
display:flex;gap:6px;
}
.admin button{
font-size:11px;padding:6px 8px;
border-radius:8px;border:none;
cursor:pointer;
}
.reset{background:gold;color:#000}
.shuffle{background:#ff7043;color:#000}
</style>
</head>

<body>

<div id="loader"><div class="ball"></div></div>

<div class="admin">
<button class="reset" onclick="adminReset()">Reset</button>
<button class="shuffle" onclick="adminShuffle()">Shuffle</button>
</div>

<div class="container">
<h1>Random Team</h1>

<div class="card" id="form">
<input id="name" placeholder="Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
<button class="btn player" onclick="selectRole('player')">Ø¨Ø§Ø²ÛŒÚ©Ù†</button>
<button class="btn keeper" onclick="selectRole('keeper')">Ø¯Ø±ÙˆØ§Ø²Ù‡â€ŒØ¨Ø§Ù†</button>
<button class="btn submit hidden" id="submitBtn" onclick="submitForm()">Ø«Ø¨Øª</button>
</div>

<div class="teams">
<div class="team">
<h3>Team A</h3>
<ul id="teamA"></ul>
<h3>Sub A</h3>
<ul id="subA"></ul>
</div>
<div class="team">
<h3>Team B</h3>
<ul id="teamB"></ul>
<h3>Sub B</h3>
<ul id="subB"></ul>
</div>
</div>
</div>

<script>
// ðŸ”´ Firebase config (Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù†)
firebase.initializeApp({
apiKey: "API_KEY",
authDomain: "PROJECT.firebaseapp.com",
databaseURL: "https://PROJECT.firebaseio.com",
projectId: "PROJECT"
});
const db = firebase.database();

setTimeout(()=>document.getElementById('loader').style.display='none',500);

let role=null;
function selectRole(r){
role=r;
document.getElementById('submitBtn').classList.remove('hidden');
}

const uidKey="joined_v1";
if(localStorage.getItem(uidKey)) document.getElementById('form').style.display='none';

function submitForm(){
const name=document.getElementById('name').value.trim();
if(!name||!role) return alert("Ù†Ø§Ù… Ùˆ Ù†Ù‚Ø´ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯");

db.ref("players").push({name,role});
localStorage.setItem(uidKey,"1");
document.getElementById('form').style.display='none';
}

db.ref("players").on("value",snap=>{
let data=snap.val()||{};
let players=Object.values(data);
render(players);
});

function render(players){
let A=[],B=[],subA=[],subB=[];
let keepA=false,keepB=false;

players.sort(()=>Math.random()-0.5);

players.forEach(p=>{
let target;
if(!keepA && p.role=="keeper"){A.push(p);keepA=true;return}
if(!keepB && p.role=="keeper"){B.push(p);keepB=true;return}

target = A.length<=B.length ? A : B;
if(target.length<5) target.push(p);
else (target===A?subA:subB).push(p);
});

fill("teamA",A);fill("teamB",B);
fill("subA",subA);fill("subB",subB);
}

function fill(id,list){
const el=document.getElementById(id);
el.innerHTML="";
list.forEach(p=>{
let li=document.createElement("li");
li.textContent=p.name+(p.role=="keeper"?" ðŸ§¤":"");
el.appendChild(li);
});
}

function adminReset(){
if(prompt("Ø±Ù…Ø² Ø§Ø¯Ù…ÛŒÙ†")!=="admin12345")return;
db.ref("players").remove();
localStorage.removeItem(uidKey);
location.reload();
}

function adminShuffle(){
if(prompt("Ø±Ù…Ø² Ø§Ø¯Ù…ÛŒÙ†")!=="admin12345")return;
db.ref("players").once("value",snap=>{
let arr=Object.values(snap.val()||{}).sort(()=>Math.random()-0.5);
db.ref("players").set(arr);
});
}
</script>
</body>
</html>
