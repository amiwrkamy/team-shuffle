<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Random Team</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
*{box-sizing:border-box;font-family:tahoma}
body{
margin:0;
background:radial-gradient(circle at top,#1e88e5,#0d47a1,#000);
color:#fff;
min-height:100vh;
display:flex;
justify-content:center;
align-items:center;
}

#loader{
position:fixed;
inset:0;
background:#000;
display:flex;
justify-content:center;
align-items:center;
z-index:10;
animation:fadeOut .5s ease .5s forwards;
}
@keyframes fadeOut{to{opacity:0;visibility:hidden}}

.ball{
width:80px;height:80px;
border-radius:50%;
background:radial-gradient(circle,#fff,#000);
animation:spin .5s linear;
}
@keyframes spin{to{transform:rotate(360deg)}}

.container{
width:95%;
max-width:420px;
background:rgba(0,0,0,.5);
border-radius:20px;
padding:15px;
box-shadow:0 0 30px rgba(255,255,255,.2);
}

.top-admin{
display:flex;
justify-content:space-between;
font-size:12px;
opacity:.7;
margin-bottom:8px;
}

button{
border:none;
padding:12px;
border-radius:12px;
font-size:16px;
cursor:pointer;
color:#fff;
width:100%;
margin-top:8px;
}

.player{background:#2196f3}
.goalkeeper{background:#e53935}
.submit{background:linear-gradient(135deg,#00c853,#00b0ff)}
.admin{background:linear-gradient(135deg,#fbc02d,#ff9800);font-size:12px}

input{
width:100%;
padding:12px;
border-radius:10px;
border:none;
font-size:16px;
margin-top:8px;
}

.teams{
margin-top:15px;
display:grid;
grid-template-columns:1fr 1fr;
gap:10px;
}

.team{
background:rgba(255,255,255,.1);
border-radius:15px;
padding:8px;
}

.team h3{
text-align:center;
margin:5px 0;
font-size:16px;
}

.name{
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
font-size:14px;
padding:2px 0;
}

.hidden{display:none}
</style>
</head>

<body>

<div id="loader">
  <div class="ball"></div>
</div>

<div class="container">

<div class="top-admin">
<span onclick="adminReset()">Reset</span>
<span onclick="adminShuffle()">Shuffle</span>
</div>

<div id="step1">
<input id="nameInput" placeholder="Ø§Ø³Ù… Ø®ÙˆØ¯Øª Ø±Ùˆ ÙˆØ§Ø±Ø¯ Ú©Ù†">
<button class="submit" onclick="goStep2()">Ø§Ø¯Ø§Ù…Ù‡</button>
</div>

<div id="step2" class="hidden">
<button class="player" onclick="register('player')">Ø¨Ø§Ø²ÛŒÚ©Ù†</button>
<button class="goalkeeper" onclick="register('goalkeeper')">Ø¯Ø±ÙˆØ§Ø²Ù‡â€ŒØ¨Ø§Ù†</button>
</div>

<div class="teams">
<div class="team">
<h3>Team A</h3>
<div id="teamA"></div>
<h3>Sub</h3>
<div id="subA"></div>
</div>
<div class="team">
<h3>Team B</h3>
<div id="teamB"></div>
<h3>Sub</h3>
<div id="subB"></div>
</div>
</div>

</div>

<script>
// ðŸ”¥ Firebase Config (Ø§ÛŒÙ†Ø¬Ø§ Ø¹ÙˆØ¶ Ú©Ù†)
const firebaseConfig = {
  apiKey: "XXXX",
  authDomain: "XXXX",
  databaseURL: "XXXX",
  projectId: "XXXX",
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø«Ø¨Øª Ø¯ÙˆØ¨Ø§Ø±Ù‡
if(localStorage.getItem("registered")){
document.getElementById("step1").classList.add("hidden");
document.getElementById("step2").classList.add("hidden");
}

// Ù…Ø±Ø§Ø­Ù„
function goStep2(){
if(!nameInput.value.trim())return;
document.getElementById("step1").classList.add("hidden");
document.getElementById("step2").classList.remove("hidden");
}

function register(role){
const name=nameInput.value.trim();
if(!name)return;

firebase.database().ref("players").push({
name,role
});

localStorage.setItem("registered","yes");
document.getElementById("step2").classList.add("hidden");
}

// Ù†Ù…Ø§ÛŒØ´ Ù„Ø§ÛŒÙˆ
firebase.database().ref("players").on("value",snap=>{
teamA.innerHTML=teamB.innerHTML=subA.innerHTML=subB.innerHTML="";
let A=[],B=[];
snap.forEach(s=>{
(Math.random()<.5?A:B).push(s.val());
});

render(A,teamA,subA);
render(B,teamB,subB);
});

function render(arr,main,sub){
let gk=false,count=0;
arr.forEach(p=>{
if(count<5 && (!gk || p.role!=="goalkeeper")){
main.innerHTML+=`<div class="name">${p.name}</div>`;
count++;
if(p.role==="goalkeeper")gk=true;
}else{
sub.innerHTML+=`<div class="name">${p.name}</div>`;
}
});
}

// Ø§Ø¯Ù…ÛŒÙ†
function adminReset(){
if(prompt("Ø±Ù…Ø²ØŸ")!=="admin12345")return;
firebase.database().ref("players").remove();
localStorage.clear();
}

function adminShuffle(){
if(prompt("Ø±Ù…Ø²ØŸ")!=="admin12345")return;
firebase.database().ref("players").once("value",snap=>{
const data=[];
snap.forEach(s=>data.push(s.val()));
firebase.database().ref("players").remove(()=>{
data.sort(()=>Math.random()-.5)
data.forEach(p=>firebase.database().ref("players").push(p));
});
}
</script>

</body>
</html>
