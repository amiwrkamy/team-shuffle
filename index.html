<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Random Team</title>

<style>
*{box-sizing:border-box;font-family:tahoma}
body{
  margin:0;
  min-height:100vh;
  background:radial-gradient(circle at top,#1e90ff,#0b1c2d 60%,#000);
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* Ù„ÙˆØ¯ÛŒÙ†Ú¯ */
#loader{
  position:fixed;
  inset:0;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:999;
}
#ball{
  font-size:90px;
  animation:spin .5s linear forwards;
}
@keyframes spin{
  to{transform:rotate(360deg);opacity:0}
}

/* Ù‡Ø¯Ø± Ø§Ø¯Ù…ÛŒÙ† */
#adminHeader{
  position:fixed;
  top:6px;
  right:8px;
  display:flex;
  gap:8px;
  z-index:50;
}
.adminBtn{
  background:rgba(255,215,0,.85);
  border:none;
  border-radius:8px;
  padding:4px 8px;
  font-size:11px;
  cursor:pointer;
  color:#000;
}
.adminBtn:hover{background:#ffd700}

/* Ø¨Ø§Ú©Ø³ Ø§ØµÙ„ÛŒ */
#app{
  width:95%;
  max-width:420px;
  background:linear-gradient(145deg,#0f2a44,#08131f);
  border-radius:20px;
  padding:14px;
  box-shadow:0 0 30px rgba(0,0,0,.7);
  display:none;
}

/* Ù…Ø±Ø§Ø­Ù„ */
h2{text-align:center;font-size:17px;margin:8px 0}

input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  font-size:15px;
  margin-bottom:10px;
}

.btn{
  width:100%;
  padding:12px;
  margin:6px 0;
  border:none;
  border-radius:14px;
  font-size:15px;
  cursor:pointer;
  color:#fff;
}

.player{background:#1e90ff}
.gk{background:#e63946}
.submit{
  background:linear-gradient(145deg,#00ffcc,#0099ff);
  font-weight:bold;
}

.hidden{display:none}

/* ØªÛŒÙ…â€ŒÙ‡Ø§ */
.teams{
  display:flex;
  gap:10px;
  margin-top:10px;
}
.team{
  flex:1;
  background:rgba(0,0,0,.4);
  border-radius:12px;
  padding:6px;
}
.team h3{text-align:center;font-size:14px;margin:4px 0}
ul{padding:0;margin:0;list-style:none}
li{
  font-size:13px;
  padding:2px 0;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.sub{color:#ffd166}
</style>
</head>

<body>

<div id="loader"><div id="ball">âš½</div></div>

<!-- Ø§Ø¯Ù…ÛŒÙ† Ø¨Ø§Ù„Ø§ -->
<div id="adminHeader">
  <button class="adminBtn" onclick="adminAction('mix')">Mix</button>
  <button class="adminBtn" onclick="adminAction('reset')">Reset</button>
</div>

<div id="app">

  <div id="step1">
    <h2>Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</h2>
    <input id="nameInput" placeholder="Ù†Ø§Ù…">
    <button class="btn submit" onclick="goStep2()">Ø§Ø¯Ø§Ù…Ù‡</button>
  </div>

  <div id="step2" class="hidden">
    <button class="btn player" onclick="register('player')">Ø¨Ø§Ø²ÛŒÚ©Ù†</button>
    <button class="btn gk" onclick="register('gk')">Ø¯Ø±ÙˆØ§Ø²Ù‡â€ŒØ¨Ø§Ù†</button>
  </div>

  <div id="teams" class="hidden">
    <div class="teams">
      <div class="team">
        <h3>Team A</h3>
        <ul id="A"></ul>
        <ul id="A_sub"></ul>
      </div>
      <div class="team">
        <h3>Team B</h3>
        <ul id="B"></ul>
        <ul id="B_sub"></ul>
      </div>
    </div>
  </div>

</div>

<script>
setTimeout(()=>{
  loader.style.display='none'
  app.style.display='block'
  loadTeams()
},500)

const key="randomTeamData"
const used="registeredOnce"

function data(){
  return JSON.parse(localStorage.getItem(key)) || {A:[],B:[],A_sub:[],B_sub:[]}
}
function save(d){localStorage.setItem(key,JSON.stringify(d))}

function goStep2(){
  if(!nameInput.value.trim())return
  if(localStorage.getItem(used)){showTeams();return}
  step1.classList.add('hidden')
  step2.classList.remove('hidden')
}

function register(role){
  const name=nameInput.value.trim()
  if(!name)return
  let d=data()
  let teams=['A','B'].sort(()=>Math.random()-.5)
  let placed=false

  for(let t of teams){
    if(d[t].length<5){
      if(role==='gk' && d[t].some(x=>x.role==='gk'))continue
      d[t].push({name,role});placed=true;break
    }
  }
  if(!placed){
    d[teams[Math.floor(Math.random()*2)]+"_sub"].push({name,role})
  }

  save(d)
  localStorage.setItem(used,"1")
  showTeams()
}

function showTeams(){
  step1.classList.add('hidden')
  step2.classList.add('hidden')
  teams.classList.remove('hidden')
  render()
}

function render(){
  let d=data()
  ;['A','B','A_sub','B_sub'].forEach(id=>{
    document.getElementById(id).innerHTML=''
    d[id].forEach(p=>{
      let li=document.createElement('li')
      li.textContent=(id.includes('sub')?'ðŸ” ':'')+(p.role==='gk'?'ðŸ§¤ ':'âš½ ')+p.name
      if(id.includes('sub'))li.className='sub'
      document.getElementById(id).appendChild(li)
    })
  })
}

function loadTeams(){
  if(localStorage.getItem(used))showTeams()
}

function adminAction(type){
  let pass=prompt("Ø±Ù…Ø² Ø§Ø¯Ù…ÛŒÙ†:")
  if(pass!=="admin12345")return
  if(type==='reset'){localStorage.clear();location.reload()}
  if(type==='mix'){
    let all=[]
    Object.values(data()).flat().forEach(x=>all.push(x))
    localStorage.clear()
    all.forEach(p=>{nameInput.value=p.name;register(p.role)})
  }
}
</script>

</body>
</html>
